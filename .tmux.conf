# Truecolor + sane terminfo
set -g default-terminal "tmux-256color"
set -as terminal-overrides ",xterm-256color:RGB"
set -sg escape-time 10

### PREFIX
unbind C-b
set-option -g prefix C-a
bind-key C-a send-prefix

# Auto-create nvim + bash windows for every new session
set-hook -g after-new-session 'run-shell "~/.tmux/init-windows.sh #{session_name}"'


bind 0 select-window -t 0
bind 1 select-window -t 1


### BETTER SPLITS
bind | split-window -h
bind - split-window -v
unbind '"'
unbind %

### RELOAD
bind r source-file ~/.tmux.conf \; display "Reloaded tmux config"

### EASY NAVIGATION (vim style)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

### NAVIGATE SESSIONS
bind C-l switch-client -n
bind C-h switch-client -p

# Kill current session ONLY if there is another one.
# After killing, automatically switch to the other session.
bind X run-shell '
current=$(tmux display-message -p "#S")
sessions=$(tmux list-sessions | wc -l)

if [ "$sessions" -le 1 ]; then
  tmux display-message "Not killing the last session"
else
  other=$(tmux list-sessions -F "#S" | grep -v "^$current$" | head -n1)
  tmux switch-client -t "$other"
  tmux kill-session -t "$current"
fi
'


### RESIZE PANES
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

### WINDOW MANAGEMENT
bind c new-window
bind n next-window
bind p previous-window
bind & kill-window
bind x kill-pane

### MOUSE SUPPORT
set -g mouse on

### FIX ESC DELAY (important for neovim)
set -sg escape-time 10

### TRUE COLOR
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"

### STATUS BAR — Rose Pine Friendly
set -g status-style "bg=default fg=#e0def4"

# left side
set -g status-left "#[fg=#eb6f92] #[fg=#191724,bg=#eb6f92]  #[bg=default,fg=#eb6f92] "

# right side
set -g status-right "#[fg=#31748f]#[fg=#191724,bg=#31748f] %Y-%m-%d #[fg=#c4a7e7]• #[fg=#191724]#H #[fg=#31748f,bg=default]"

### WINDOW TABS
set -g window-status-format        "#[fg=#6e6a86] #I:#W "
set -g window-status-current-format "#[fg=#c4a7e7] #I:#W "

### TRANSPARENT BACKGROUND
set -g window-style 'bg=default'
set -g window-active-style 'bg=default'

